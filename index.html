<!DOCTYPE html>
<html lang="fa">
<head>
<meta charset="UTF-8">
<title>Ú†Øª ØªØ³Øª</title>
</head>
<body>

<h2>ðŸ’¬ Ú†Øª ØªØ³Øª</h2>

<input id="name" placeholder="Ù†Ø§Ù…">
<input id="msg" placeholder="Ù¾ÛŒØ§Ù…">
<button onclick="send()">Ø§Ø±Ø³Ø§Ù„</button>

<div id="chat"></div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.9.0/firebase-app.js";
import {
  getFirestore, collection, addDoc,
  query, orderBy, onSnapshot
} from "https://www.gstatic.com/firebasejs/12.9.0/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyBQdlikBbxE0_U_meQ2PiNas3dlt6-OvPA",
  authDomain: "irn-chat.firebaseapp.com",
  projectId: "irn-chat",
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

const chatBox = document.getElementById("chat");

function send(){
  addDoc(collection(db,"messages"),{
    name: document.getElementById("name").value || "Ù†Ø§Ø´Ù†Ø§Ø³",
    text: document.getElementById("msg").value,
    time: Date.now()
  });
}

const q = query(collection(db,"messages"), orderBy("time"));
onSnapshot(q, snap=>{
  chatBox.innerHTML="";
  snap.forEach(doc=>{
    const d = doc.data();
    chatBox.innerHTML += `<p><b>${d.name}</b>: ${d.text}</p>`;
  });
});
</script>

</body>
</html>
