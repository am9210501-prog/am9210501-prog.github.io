<!DOCTYPE html>
<html lang="fa">
<head>
<meta charset="UTF-8">
<title>Ø«Ø¨Øªâ€ŒÙ†Ø§Ù… Ù¾ÛŒØ§Ù…â€ŒØ±Ø³Ø§Ù†</title>
</head>
<body>

<div id="register">
  <h2>Ø«Ø¨Øªâ€ŒÙ†Ø§Ù…</h2>
  <input id="regName" placeholder="Ù†Ø§Ù… Ø®ÙˆØ¯ Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯ (Ù…Ø«Ø§Ù„: Ù…Ø­Ù…Ø¯)">
  <input id="regPhone" placeholder="Ø´Ù…Ø§Ø±Ù‡ ÛŒØ§ Ø¢ÛŒØ¯ÛŒ (Ø§Ø®ØªÛŒØ§Ø±ÛŒ)">
  <button onclick="registerUser()">Ø«Ø¨Øªâ€ŒÙ†Ø§Ù…</button>
</div>

<div id="welcome" style="display:none;">
  <h2 id="welcomeMsg"></h2>
  <p>Ø®ÙˆØ´Ø­Ø§Ù„Ù… Ø§Ø² Ø¯ÛŒØ¯Ù†Øª ðŸ˜Ž</p>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.9.0/firebase-app.js";
import { getFirestore, collection, addDoc, serverTimestamp } from "https://www.gstatic.com/firebasejs/12.9.0/firebase-firestore.js";

// ØªÙ†Ø¸ÛŒÙ…Ø§Øª Firebase Ù¾Ø±ÙˆÚ˜Ù‡ Ø®ÙˆØ¯Øª
const firebaseConfig = {
  apiKey: "AIzaSyBQdlikBbxE0_U_meQ2PiNas3dlt6-OvPA",
  authDomain: "irn-chat.firebaseapp.com",
  projectId: "irn-chat",
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

// ØªØ§Ø¨Ø¹ Ø«Ø¨Øªâ€ŒÙ†Ø§Ù…
async function registerUser() {
  const name = document.getElementById("regName").value.trim();
  const phone = document.getElementById("regPhone").value.trim();

  if(!name) {
    alert("Ù†Ø§Ù… Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯!");
    return;
  }

  try {
    const docRef = await addDoc(collection(db, "users"), {
      name: name,
      phone: phone,
      time: serverTimestamp()
    });

    // Ù†Ù…Ø§ÛŒØ´ Ù¾ÛŒØ§Ù… Ø®ÙˆØ´â€ŒØ¢Ù…Ø¯Ú¯ÙˆÛŒÛŒ
    document.getElementById("register").style.display = "none";
    document.getElementById("welcome").style.display = "block";
    document.getElementById("welcomeMsg").innerText = `Ø¨Ù‡ Ø³Ø§ÛŒØª Ø®ÙˆØ´ Ø¢Ù…Ø¯ÛŒØŒ ${name}!`;

    console.log("Ú©Ø§Ø±Ø¨Ø± Ø«Ø¨Øª Ø´Ø¯ Ø¨Ø§ ID: ", docRef.id);

  } catch (e) {
    console.error("Ø®Ø·Ø§ Ø¯Ø± Ø«Ø¨Øªâ€ŒÙ†Ø§Ù…: ", e);
    alert("Ø®Ø·Ø§ Ø¯Ø± Ø«Ø¨Øªâ€ŒÙ†Ø§Ù…! Ø¯ÙˆØ¨Ø§Ø±Ù‡ ØªÙ„Ø§Ø´ Ú©Ù†ÛŒØ¯.");
  }
}
</script>

</body>
</html>
